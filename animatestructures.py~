import sys
sys.path.append("/usr/local/lib/python2.7/site-packages/")

from BackboneDBN.DBN import FB5DBN, TorusDBN

dbn = TorusDBN(start_state="UNIFORM",transition_state="UNIFORM")

seq = "GVQVETISPGDGRTFPKRGQTCVVHYTGMLEDGKKFDSSRDRNKPFKFMLGKQEVIRGWEEGVAQMSVGQRAKLTISPDYAYGATGHPGIIPPHATLVFDVELLKLE"
ang = [[1.2178, 0.377777],[-1.52567, 2.38942],[-1.8515, 2.3645],[-1.88699, 2.22689],[-1.94517, 2.12989],[-1.3903, 2.29486],[-1.69377, -0.674076],[-2.56265, 2.444],[-1.17555, 2.59911],[-1.99169, -3.10024],[-1.52941, -0.093416],[1.2074, 0.383224],[-1.97005, -0.160593],[-1.61332, 2.08847],[-1.79184, 2.37602],[-1.17918, 2.56865],[-1.99601, 2.60352],[-1.07645, 2.30174],[1.64381, -0.183243],[-1.39361, 2.60432],[-1.74618, 2.34336],[-2.07148, 2.32479],[-2.03938, 2.28667],[-2.10297, 2.34696],[-1.96708, 2.27372],[-2.26155, 2.62634],[-2.27046, 2.36409],[-2.04913, 2.39394],[-2.26693, 2.5973],[-1.52295, 2.73757],[-1.05973, -0.554046],[-1.50495, -0.118061],[1.59261, 0.0264871],[-1.47717, 2.46113],[-1.12969, 2.34444],[-1.80369, -0.278877],[-2.73832, 2.70733],[-2.60729, 2.5617],[-1.56127, -0.153704],[-1.06447, -0.692046],[-1.1168, -0.528933],[-1.52853, -0.104718],[1.21245, 0.368784],[-2.28013, 2.09797],[-1.16868, 2.58671],[-1.60578, 2.41545],[-2.07149, 2.54],[-2.45333, 2.67543],[-1.61223, 2.31752],[-1.78425, 2.39002],[1.16405, 0.47431],[-1.90932, 0.0871968],[1.36515, 0.242108],[-1.57078, -0.500132],[-2.34466, 2.72053],[-1.18898, 2.53343],[-1.02947, -0.662308],[-1.07551, -0.718211],[-1.09864, -0.733191],[-1.09928, -0.652621],[-1.26794, -0.560429],[-1.10267, -0.74277],[-1.04411, -0.766039],[-1.16156, -0.430216],[-1.61231, -0.0509401],[-1.71999, 2.40168],[-1.7945, 2.76111],[-1.085, 2.29807],[1.60182, -0.168388],[-1.41888, 2.62797],[-1.87194, 2.43412],[-2.5108, 2.73729],[-1.98123, 2.29567],[-1.86315, 2.1687],[-1.84205, 2.19932],[-1.9032, 2.22421],[-1.17651, 2.57621],[-1.01314, -0.595659],[-1.08824, -0.512952],[-1.79479, 0.114188],[-2.11346, -2.21118],[-1.86592, 0.0907811],[1.12992, -2.50689],[-1.24326, -0.28823],[-1.60533, -0.47096],[1.59586, -2.89025],[-2.20886, 2.3981],[-1.08909, 2.31436],[1.34255, 0.223326],[-1.67804, -0.444529],[-2.15739, 2.2822],[-1.16218, 2.58712],[-1.1254, 2.43004],[1.05201, 0.614981],[-1.57948, 2.57847],[-1.82885, 2.30932],[-1.91675, 2.28285],[-1.94465, 2.21138],[-2.02865, 2.24826],[-1.64762, 2.01137],[-2.12427, 2.50262],[-2.0933, 2.25433],[-1.51368, 2.1669],[-1.48394, -0.768446],[-2.52109, 2.58377],[-1.79706, 2.31933],[-1.96954, -0.0903121]]

dbn.init(angles_seq=ang)
structure = dbn.get_structure()

dbn.save_structure("test_predicted.pdb", structure)
